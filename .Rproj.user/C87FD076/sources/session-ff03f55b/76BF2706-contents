#' Predictions for non-random parameters count models
#'
#' @name mle.predict
#' @param model a model object estimated using any of the models other than the random parameters (\code{rpnb}).
#' @param data a dataframe that has all of the variables in the \code{formula} and \code{rpar_formula}. This can be the data used for estimating the model or another dataframe.
#'
#' @import stats
#'
#' @examples
#' \donttest{
#'
#' ## Standard Negative Binomial
#' data("washington_roads")
#' nbg <- nbg(Total_crashes ~ - 1 + lnlength + speed50,
#'            data = washington_roads)
#'
#' predictions <- mle.predict(nbg, washington_roads)
#' print(predictions)}
mle.predict <- function(model, data){

  modtype <- model$modelType 
  if(modtype=="rpnb"){
    print('Use the function `rpnb.predict` for predictions based on the random parameters negative binomial models')
    stop()
  }

  mod_df <- stats::model.frame(model$formula, data)
  X <- stats::model.matrix(model$formula, data)
  y <- as.numeric(stats::model.response(mod_df))

  beta_pred <- model$beta_pred
  
  if (modtype=="posLogn"){
    predictions <- exp(X %*% beta_pred + model$sigma^2/2)
  }
  else{
    predictions <- exp(X %*% beta_pred)
  }
  return(predictions)
}
