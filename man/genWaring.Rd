% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genWaring.R
\name{genWaring}
\alias{genWaring}
\title{Function for estimating a Generalized Waring regression model}
\usage{
genWaring(formula, data, method = "BHHH", max.iters = 1000)
}
\arguments{
\item{formula}{an R formula.}

\item{data}{a dataframe that has all of the variables in  `formula`.}

\item{method}{a method to use for optimization in the maximum likelihood estimation. For options, see \code{\link[maxLik]{maxLik}} documentation.}

\item{max.iters}{the maximum number of iterations to allow the optimization method to perform.}
}
\description{
Function for estimating a Generalized Waring regression model
}
\details{
# Generalized Waring Probability Mass Function, Mean, and Variance
The following are the versions of the PMF, mean, and variance used in this function. This is adjusted from the typical formulation by replacing parameter \code{k} with \eqn{\mu}
\deqn{PMF=\frac{\Gamma(\alpha+\gamma)\Gamma(\alpha+\rho+x)\Gamma(\rho+\gamma)}{\Gamma(\alpha+\rho)\Gamma(\gamma+\rho+x)\Gamma(\alpha+\gamma+\rho+x)}\left(\frac{\rho}{\alpha+\rho}\right)}
\deqn{\mu=e^{X\beta}=\frac{\alpha\rho}{\gamma(\alpha+\rho)}}
\deqn{\sigma^2=\frac{\alpha\rho(\alpha+\rho+\gamma)}{\gamma^2(\alpha+\rho)^2(\alpha+\rho+1)}}

Where \eqn{\alpha} and \eqn{\rho} are distribution parameters with the constraints that \eqn{\alpha\geq 0} and \eqn{\rho\geq 0}, \eqn{X} is a matrix of predictors, and \eqn{\beta} is a vector of coefficients.

If we use:
\deqn{\gamma=\frac{\mu(\alpha+\rho)}{\alpha\rho}}

The PMF becomes:

\deqn{PMF=\frac{\Gamma(\alpha + \rho) \Gamma\left(\alpha + \frac{2\mu}{\rho} + x\right) \Gamma\left(\frac{2\mu}{\rho} + \rho\right)}{\Gamma\left(\alpha + \frac{2\mu}{\rho}\right) \Gamma\left(\frac{2\mu}{\rho} + \rho + x\right) \Gamma\left(\alpha + \rho + \frac{2\mu}{\rho} + x\right)} \left( \frac{\frac{2\mu}{\rho}}{\alpha + \frac{2\mu}{\rho}} \right)}

#' This results in a regression model where:
\deqn{\mu=e^{X\beta}}
\deqn{\sigma^2=\mu\left(1-\frac{1}{\alpha+\rho+1}\right)+\mu^2\frac{(\alpha+\rho)^2}{\alpha\rho(\alpha+\rho+1)}}
}
\examples{
\donttest{

# Generalized Waring Model
data("washington_roads")
washington_roads$AADTover10k <- ifelse(washington_roads$AADT>10000,1,0) # create a dummy variable
genwaring.mod <- genWaring(Total_crashes ~ lnaadt + lnlength + speed50 +
                                ShouldWidth04 + AADTover10k,
                                data=washington_roads)
summary(genwaring.mod)}
}
