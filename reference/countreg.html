<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Count regression models — countreg • flexCountReg</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Count regression models — countreg"><meta name="description" content="The purpose of this function is to estimate count regression models using
maximum likelihood estimation (MLE) or Maximum Simulated Likelihood
Estimation (MSLE). The function can estimate the following models:
Poisson (Poisson)
Negative Binomial 1 (NB1)
Negative Binomial 2 (NB2)
Negative Binomial P (NBP)
Poisson-Lognormal (PLN)
Poisson-Generalized-Exponential (PGE)
Poisson-Inverse-Gaussian Type 1 (PIG1)
Poisson-Inverse-Gaussian Type 2 (PIG2)
Poisson-Inverse-Gamma (PIG)
Poisson-Lindley (PL)
Poisson-Lindley-Gamma (PLG), also known as the Negative
       Binomial-Lindley (NBL)
Poisson-Lindley-Lognormal (PLL)
Poisson-Weibull (PW)
Sichel (SI)
Generalized Waring (GW)
Conway-Maxwell-Poisson (COM)

"><meta property="og:description" content="The purpose of this function is to estimate count regression models using
maximum likelihood estimation (MLE) or Maximum Simulated Likelihood
Estimation (MSLE). The function can estimate the following models:
Poisson (Poisson)
Negative Binomial 1 (NB1)
Negative Binomial 2 (NB2)
Negative Binomial P (NBP)
Poisson-Lognormal (PLN)
Poisson-Generalized-Exponential (PGE)
Poisson-Inverse-Gaussian Type 1 (PIG1)
Poisson-Inverse-Gaussian Type 2 (PIG2)
Poisson-Inverse-Gamma (PIG)
Poisson-Lindley (PL)
Poisson-Lindley-Gamma (PLG), also known as the Negative
       Binomial-Lindley (NBL)
Poisson-Lindley-Lognormal (PLL)
Poisson-Weibull (PW)
Sichel (SI)
Generalized Waring (GW)
Conway-Maxwell-Poisson (COM)

"><meta property="og:image" content="https://jwood-iastate.github.io/flexCountReg/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexCountReg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Count regression models</h1>

      <div class="d-none name"><code>countreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The purpose of this function is to estimate count regression models using
maximum likelihood estimation (MLE) or Maximum Simulated Likelihood
Estimation (MSLE). The function can estimate the following models:</p><ul><li><p>Poisson (Poisson)</p></li>
<li><p>Negative Binomial 1 (NB1)</p></li>
<li><p>Negative Binomial 2 (NB2)</p></li>
<li><p>Negative Binomial P (NBP)</p></li>
<li><p>Poisson-Lognormal (PLN)</p></li>
<li><p>Poisson-Generalized-Exponential (PGE)</p></li>
<li><p>Poisson-Inverse-Gaussian Type 1 (PIG1)</p></li>
<li><p>Poisson-Inverse-Gaussian Type 2 (PIG2)</p></li>
<li><p>Poisson-Inverse-Gamma (PIG)</p></li>
<li><p>Poisson-Lindley (PL)</p></li>
<li><p>Poisson-Lindley-Gamma (PLG), also known as the Negative
       Binomial-Lindley (NBL)</p></li>
<li><p>Poisson-Lindley-Lognormal (PLL)</p></li>
<li><p>Poisson-Weibull (PW)</p></li>
<li><p>Sichel (SI)</p></li>
<li><p>Generalized Waring (GW)</p></li>
<li><p>Conway-Maxwell-Poisson (COM)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">countreg</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"NB2"</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dis_param_formula_1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dis_param_formula_2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  underreport_formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  underreport_family <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>  ndraws <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"NM"</span>,</span>
<span>  max.iters <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  start.vals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stderr <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  bootstraps <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a symbolic description of the model to be fitted.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data frame containing the variables in the model.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>the name of the distribution/model type to estimate. The
default "NB2" is the standard negative binomial distribution with a
log link. other options are listed below.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>the name of a variable, or vector of variable names, in the
data frame that should be used as an offset (i.e., included but forced to
have a coefficient of 1). The normal method of setting an offset in the
equation can also be used (overrides the offset option).</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>the name of a variable in the data frame that should be used
as a frequency weight.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>an optional parameter. If `TRUE`, the function will print out
the progress of the model fitting. Default is `FALSE`.</p></dd>


<dt id="arg-dis-param-formula-">dis_param_formula_1<a class="anchor" aria-label="anchor" href="#arg-dis-param-formula-"></a></dt>
<dd><p>a symbolic description of the model for the
natural log of the dispersion parameter or first parameter of the count
distribution used. Further details are provided below.</p></dd>


<dt id="arg-dis-param-formula-">dis_param_formula_2<a class="anchor" aria-label="anchor" href="#arg-dis-param-formula-"></a></dt>
<dd><p>a symbolic description of the model for the second
parameter of the count distribution used. Further details are provided
below.</p></dd>


<dt id="arg-underreport-formula">underreport_formula<a class="anchor" aria-label="anchor" href="#arg-underreport-formula"></a></dt>
<dd><p>an optional formula to estimate the underreporting
for any of the count model options. The underreporting is estimated as a
function (logit or probit) of the predictors in the model. For the model to
be tractable, the independent variables cannot be the exact same as the
count model. The default is `NULL`.</p></dd>


<dt id="arg-underreport-family">underreport_family<a class="anchor" aria-label="anchor" href="#arg-underreport-family"></a></dt>
<dd><p>the name of the distribution/model type to estimate
the underreporting portion of the model when `underreport_formula` is
specified. The default is "logit" for a binary logistic regression model.
The other option is "probit" for a probit model.</p></dd>


<dt id="arg-ndraws">ndraws<a class="anchor" aria-label="anchor" href="#arg-ndraws"></a></dt>
<dd><p>The number of Halton draws for integrating the distribution
being compounded with the Poisson distribution when there is not a
closed-form solution. Default is 1500. It is recommended to test different
numbers of draws to determine if the model is stable (i.e., doesn't change
or has minimal change as the number of draws changes within a reasonable
range).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Optimization method to be used for maximum likelihood
estimation. See `maxLik` documentation for options. The default is "NM" for
the Nelder-Mead method.</p></dd>


<dt id="arg-max-iters">max.iters<a class="anchor" aria-label="anchor" href="#arg-max-iters"></a></dt>
<dd><p>Maximum number of iterations for the optimization method.</p></dd>


<dt id="arg-start-vals">start.vals<a class="anchor" aria-label="anchor" href="#arg-start-vals"></a></dt>
<dd><p>Optional vector of starting values for the optimization.</p></dd>


<dt id="arg-stderr">stderr<a class="anchor" aria-label="anchor" href="#arg-stderr"></a></dt>
<dd><p>Type of standard errors to use. The default is "normal". Other
options include "boot" for bootstrapped standard errors, or "robust" for
robust standard errors.</p></dd>


<dt id="arg-bootstraps">bootstraps<a class="anchor" aria-label="anchor" href="#arg-bootstraps"></a></dt>
<dd><p>Optional integer specifying the number of bootstrap samples
to be used for estimating standard errors when `stderr`= "boot". Note that
this currently does not work when an offset variable is used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class `countreg` which is a list with the following components:</p><ul><li><p>model: the fitted model object.</p></li>
<li><p>data: the data frame used to fit the model.</p></li>
<li><p>call: the matched call.</p></li>
<li><p>formula: the formula used to fit the model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For the `family` argument, the following options are available:</p><ul><li><p>"POISSON" for Poisson distribution with a log link.</p></li>
<li><p>"NB1" for Negative Binomial 1 distribution with a log link.</p></li>
<li><p>"NB2" for Negative Binomial 2 distribution with a log link (i.e., the
       standard negative binomial model).</p></li>
<li><p>"NBP" for Negative Binomial P distribution with a log link.</p></li>
<li><p>"PLN" for Poisson-Lognormal distribution with a log link.</p></li>
<li><p>"PGE" for Poisson-Generalized-Exponential distribution with a log
       link.</p></li>
<li><p>"PIG1" for Poisson-Inverse-Gaussian Type-1 distribution with a log
 link.</p></li>
<li><p>"PIG2" for Poisson-Inverse-Gaussian Type-2 distribution with a log
 link.</p></li>
<li><p>"PIG" for Poisson-Inverse-Gamma distribution with a log link.</p></li>
<li><p>"PL" for Poisson-Lindley distribution with a log link.</p></li>
<li><p>"PLG" for Poisson-Lindley-Gamma distribution with a log link.</p></li>
<li><p>"PLL" for Poisson-Lindley-Lognormal distribution with a log link.</p></li>
<li><p>"PW" for Poisson-Weibull distribution with a log link.</p></li>
<li><p>"SI" for Sichel distribution with a log link.</p></li>
<li><p>"GW" for Generalized Waring distribution with a log link.</p></li>
<li><p>"COM" for Conway-Maxwell-Poisson (COM) distribution with a log link.</p></li>
</ul><p>The `dis_param_formula_1` and `dis_param_formula_2` parameters are used to
 estimate the dispersion parameter or other parameters of the count
 distribution used. This leads to the distributions parameters being
 functions rather than constants in the model. For example, if the user wants
 to estimate the overdispersion parameter of the Negative Binomial 2
 distribution as a function of the variable `x1` and `x2`, the user would
 specify `dis_param_formula_1 = ~ x1 + x2`. In the case of the Negative
 Binomial distributions, the model is known as a Generalized Negative
 Binomial model when the overdispersion parameter is specified as a function.</p>
<p>The function linking the distribution parameters to the predictors is:
 $$Param = \exp((Intercept) + \sum \beta X)$$</p>
<p>The parameters for the different models are as follows:</p>
<p>For `dis_param_formula_1`, the models are for the parameters:</p><ul><li><p>\(ln(\alpha)\) for the Negative Binomial 1 model.</p></li>
<li><p>\(ln(\alpha)\) for the Negative Binomial 2 model.</p></li>
<li><p>\(ln(\alpha)\) for the Negative Binomial P model.</p></li>
<li><p>\(ln(\sigma)\) for the Poisson-Lognormal model.</p></li>
<li><p>shape parameter for the Poisson-Generalized-Exponential model.</p></li>
<li><p>\(ln(\eta)\) for the Poisson-Inverse-Gaussian model.</p></li>
<li><p>\(ln(\eta)\) for the Poisson-Inverse-Gamma model.</p></li>
<li><p>\(ln(\theta)\) for the Poisson-Lindley model.</p></li>
<li><p>\(ln(\theta)\) for the Poisson-Lindley-Gamma model.</p></li>
<li><p>\(ln(\theta)\) for the Poisson-Lindley-Lognormal model.</p></li>
<li><p>\(ln(\alpha)\) for the Poisson-Weibull model.</p></li>
<li><p>\(\gamma\) for the Sichel model.</p></li>
<li><p>\(k\) for the Generalized Waring model.</p></li>
<li><p>\(ln(\nu)\) for the Conway-Maxwell-Poisson model.</p></li>
</ul><p>For `dis_param_formula_2`, the models are for the parameters:</p><ul><li><p>Not Applicable for the Negative Binomial 1 model.</p></li>
<li><p>Not Applicable for the Negative Binomial 2 model.</p></li>
<li><p>p for the Negative Binomial P model.</p></li>
<li><p>Not Applicable for the Poisson-Lognormal model.</p></li>
<li><p>scale parameter for the Poisson-Generalized-Exponential model.</p></li>
<li><p>Not Applicable for the Poisson-Inverse-Gaussian model.</p></li>
<li><p>Not Applicable for the Poisson-Inverse-Gamma model.</p></li>
<li><p>Not Applicable for the Poisson-Lindley model.</p></li>
<li><p>\(ln(\alpha)\) for the Poisson-Lindley-Gamma model.</p></li>
<li><p>\(ln(\sigma)\) for the Poisson-Lindley-Lognormal model.</p></li>
<li><p>\(ln(\sigma)\) for the Poisson-Weibull model.</p></li>
<li><p>\(ln(\sigma)\) for the Sichel model.</p></li>
<li><p>\(ln(\rho)\) for the Generalized Waring model.</p></li>
<li><p>Not Applicable for the Conway-Maxwell-Poisson model.</p></li>
</ul><p>The `ndraws` parameter is used to estimate the distribution when there is
 not a closed-form solution. This uses Halton draws to integrate the
 distribution being compounded with the Poisson distribution. The default is
 1500. The models this is applicable for include:</p><ul><li><p>Poisson-Lognormal</p></li>
<li><p>Poisson-Generalized-Exponential</p></li>
<li><p>Poisson-Lindley-Gamma (more efficient than using hypergeometric
 functions)</p></li>
<li><p>Poisson-Lindley-Lognormal</p></li>
<li><p>Poisson-Weibull</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="model-details">Model Details<a class="anchor" aria-label="anchor" href="#model-details"></a></h2>


<p>## Poisson Model
This implements the Poisson regression model using Maximum Likelihood
Estimation, as opposed to the Iteratively Reweighted Least Squares (IRLS)
method used in the `glm` function.</p>
<p>The PMF and log-likelihood functions are:
$$P(Y = y) = \frac{e^{-\mu} \mu^y}{y!}$$
$$LL_{\text{Poisson}}(\beta) =
       \sum_{i=1}^n \left[ -\mu_i + y_i \ln(\mu_i) - \ln(y_i!) \right]$$</p>
<p>The mean is:
$$\mu = exp(X\beta)$$</p>
<p>The variance is:
$$\text{Var}(Y) = \mu$$</p>
<p>## Negative Binomial Models**</p>
<p>The NB-1, NB-2, and NB-P versions of the negative binomial distribution are
based on Greene (2008).  The details of each of these are provided below.</p>
<p>### NB-1 Model
The PMF and log-likelihood functions are:
$$P(Y = y) =
    \frac{\Gamma(y + \frac{\mu}{\alpha})}{y! \, \Gamma(\frac{\mu}{\alpha})}
    \left( \frac{\frac{\mu}{\alpha}}{\frac{\mu}{\alpha} + \mu} \right)
    ^{\frac{\mu}{\alpha}} \left( \frac{\mu}{\frac{\mu}{\alpha} + \mu}
    \right)^y$$
$$LL_{\text{NB1}}(\beta, \alpha) = \sum_{i=1}^n \left[ \ln \Gamma\left(
y_i + \frac{\mu_i}{\alpha} \right) - \ln \Gamma\left( \frac{\mu_i}{\alpha}
\right) - \ln y_i! + \frac{\mu_i}{\alpha} \ln \left(
\frac{\frac{\mu_i}{\alpha}}{\frac{\mu_i}{\alpha} + \mu_i} \right) + y_i
\ln \left( \frac{\mu_i}{\frac{\mu_i}{\alpha} + \mu_i} \right) \right]$$</p>
<p>The mean is:
$$\mu = exp(X\beta)$$</p>
<p>The variance is:
$$\text{Var}(Y) = \mu + \alpha\mu$$</p>
<p>### NB-2 Model
The PMF and log-likelihood functions are:
$$P(Y = y) = \frac{\Gamma(y + \alpha)}{y! \, \Gamma(\alpha)}
\left( \frac{\alpha}{\alpha + \mu} \right)^\alpha
\left( \frac{\mu}{\alpha + \mu} \right)^y$$
$$LL_{\text{NB2}} = \sum_{i=1}^n \left[ \ln \Gamma(y_i + \alpha) -
\ln \Gamma(\alpha) - \ln y_i! + \alpha \ln \left( \frac{\alpha}{\alpha +
\mu_i} \right) + y_i \ln \left( \frac{\mu_i}{\alpha + \mu_i} \right) \right]$$</p>
<p>The mean is:
$$\mu = exp(X\beta)$$</p>
<p>The variance is:
$$\text{Var}(Y) = \mu + \alpha\mu^2$$</p>
<p>### NB-P Model
The PMF and log-likelihood functions are:
$$P(Y = y) = \frac{\Gamma(y + \frac{\mu^{2-p}}{\alpha})}{y! \,
\Gamma(\frac{\mu^{2-p}}{\alpha})} \left( \frac{\frac{\mu^{2-p}}{\alpha}}
{\frac{\mu^{2-p}}{\alpha} + \mu} \right)^{\frac{\mu^{2-p}}{\alpha}}
\left( \frac{\mu}{\frac{\mu^{2-p}}{\alpha} + \mu} \right)^y$$
$$LL_{\text{NBP}}(\beta, \alpha, p) = \sum_{i=1}^n \left[ \ln
\Gamma\left( y_i + \frac{\mu_i^{2-p}}{\alpha} \right) - \ln \Gamma\left(
\frac{\mu_i^{2-p}}{\alpha} \right) - \ln y_i! + \frac{\mu_i^{2-p}}{\alpha}
\ln \left( \frac{\frac{\mu_i^{2-p}}{\alpha}}{\frac{\mu_i^{2-p}}{\alpha} +
\mu_i} \right) + y_i \ln \left( \frac{\mu_i}{\frac{\mu_i^{2-p}}{\alpha} +
\mu_i} \right) \right]$$</p>
<p>The mean is:
$$\mu = exp(X\beta)$$</p>
<p>The variance is:
$$\text{Var}(Y) = \mu + \alpha\mu^P$$</p>
<p>## Poisson-Lognormal (PLN) Model
The compound Probability Mass Function(PMF) for the Poisson-Lognormal
distribution is:
$$f(y|\lambda,\sigma)=\int_0^\infty \frac{\lambda^y x^y e^{-\lambda x}}
{y!}\frac{exp\left(-\frac{ln^2(x)}{2\sigma^2} \right)}{x\sigma\sqrt{2\pi}}dx$$</p>
<p>Where \(\sigma\) is a parameter for the lognormal distribution with the
restriction \(\sigma&gt;0\), and \(y\) is a non-negative integer.</p>
<p>The expected value of the distribution is:
$$E[y]=e^{X\beta+\sigma^2/2} = \mu e^{\sigma^2/2}$$</p>
<p>When `ln.sigma.formula` is used, the parameter \(\sigma\) is modeled as:
$$ln(\sigma)=\beta_0+\beta_1 x_1 + \cdots + \beta_n x_n$$</p>
<p>Thus, the resulting value for the parameter \(\sigma\) is:
$$\sigma=e^{\beta_0+\beta_1 x_1 + \cdots + \beta_n x_n}$$</p>
<p>The t-statistics and p-values for the coefficients related to ln(sigma) are,
by default, testing if the coefficients are different from a value of 0. This
has little practical meaning given that they are coefficients for ln(sigma).
They are not testing if the coefficients have statistical significance in
terms of improvement over a Poisson model. The Likelihood-Ratio test results
provided in the output provide a test comparing if the Poisson-Lognormal
model provides a statistically significant improvement in model fit over the
Poisson model.</p>
<p>## Poisson Generalized-Exponential (PGE) Model
The Generalized Exponential distribution can be written as a function with
a shape parameter \(\alpha&gt;0\) and scale parameter \(\gamma&gt;0\). The
distribution has strictly positive continuous values. The PDF of the
distribution is:
$$f(x|\alpha,\gamma)=\frac{\alpha}{\gamma}\left(1-e^{-\frac{x}{\gamma}}
\right)^{\alpha-1}e^{-\frac{x}{\gamma}}$$</p>
<p>Thus, the compound Probability Mass Function(PMF) for the PGE distribution
is:
$$f(y|\lambda,\alpha,\beta)=\int_0^\infty \frac{\lambda^y x^y
e^{-\lambda x}}{y!}\frac{\alpha}{\gamma}\left(1-e^{-\frac{x}{\gamma}}
\right)^{\alpha-1}e^{-\frac{x}{\gamma}} dx$$</p>
<p>The expected value of the distribution is:
$$E[y]=\mu=\lambda \left(\frac{\psi(\alpha+1)-\psi(1)}{\gamma}\right)$$</p>
<p>Where \(\psi(\cdot)\) is the digamma function.</p>
<p>The variance is:
$$\sigma^2=\lambda \left(\frac{\psi(\alpha+1)-\psi(1)}{\gamma}\right) +
\left(\frac{-\psi'(\alpha+1)+\psi'(1)}{\gamma^2}\right)\lambda^2$$</p>
<p>Where \(\psi'(\cdot)\) is the trigamma function.</p>
<p>To ensure that \(\mu=e^{X\beta}\), \(\lambda\) is replaced with:
$$\lambda=\frac{\gamma e^{X\beta}}{\psi(\alpha+1)-\psi(1)}$$</p>
<p>This results in:
$$f(y|\mu,\alpha,\beta)=\int_0^\infty \frac{\left(\frac{\gamma
e^{X\beta}}{\psi(\alpha+1)-\psi(1)}\right)^y x^y e^{-\left(\frac{\gamma
e^{X\beta}}{\psi(\alpha+1)-\psi(1)}\right) x}}{y!}\frac{\alpha}{\gamma}
\left(1-e^{-\frac{x}{\gamma}}\right)^{\alpha-1}e^{-\frac{x}{\gamma}} dx$$</p>
<p>Halton draws are used to perform simulation over the lognormal distribution
to solve the integral.</p>
<p>## Poisson-Inverse-Gaussian Type 1 (PIG1)  and Type 2 (PIG2) Models
The Poisson-Inverse-Gaussian regression model is based on the
Poisson-Inverse-Gaussian Distribution.</p>
<p>The expected value of the distribution in the regression utilizes a log-link
function. Thus, the mean is:
$$\mu=e^{X\beta}$$</p>
<p>The variance function for the Type 1 distribution (which is the default) is:
$$\sigma^2=\mu+\eta\mu$$</p>
<p>While the variance for the Type 2 distribution is:
$$\sigma^2=\mu+\eta\mu^2$$</p>
<p>The parameter \(\eta\) is estimated as the natural logarithm transformed
value, \(\ln(\eta)\), to ensure that \(\eta&gt;0\).</p>
<p>## Poisson-Inverse-Gamma (PIG) Model
The PDF of the distribution is:
$$f(x|\eta,\mu)=\frac{2\left(\mu\left(\frac{1}{\eta}+1\right)\right)
^{\frac{x+\frac{1}{eta}+2}{2}}}{x!\Gamma\left(\frac{1}{\eta}+2\right)}
K_{x-\frac{1}{\eta}-2}\left(2\sqrt{\mu\left(\frac{1}{\eta}+1\right)}\right)$$</p>
<p>Where \(\eta\) is a shape parameter with the restriction that \(\eta&gt;0\),
\(\mu&gt;0\) is the mean value,  \(y\) is a non-negative integer, and
\(K_i(z)\) is the modified Bessel function of the second kind. This
formulation uses the mean directly.</p>
<p>The variance of the distribution is:
$$\sigma^2=\mu+\eta\mu^2$$</p>
<p>## Poisson-Lindley (PL) Model
The Poisson-Lindley regression is based on a compound Poisson-Lindley
distribution. It handles count outcomes with high levels of zero
observations (or other high densities at low outcome values) that standard
count regression methods, including the negative binomial, may struggle to
adequately capture or model.</p>
<p>The compound Probability Mass Function(PMF) for the Poisson-Lindley (PL)
distribution is:
$$f(y|\theta,\lambda)=\frac{\theta^2\lambda^y(\theta+\lambda+
y+1)}{(\theta+1)(\theta+\lambda)^{y+2}}$$</p>
<p>Where \(\theta\) and \(\lambda\) are distribution parameters with the
restrictions that \(\theta&gt;0\) and \(\lambda&gt;0\), and \(y\) is a
non-negative integer.</p>
<p>The expected value of the distribution is:
$$\mu=\frac{\lambda(\theta+2)}{\theta(\theta+1)}$$</p>
<p>If a log-link function is used, the mean is:
$$\mu=e^{X\beta}=\frac{\lambda(\theta+2)}{\theta(\theta+1)}$$</p>
<p>Thus, the parameter \(\lambda\) in the PL distribution when applied to
regression analysis is:
$$\lambda=\frac{\mu\theta(\theta+1)}{\theta+2}$$</p>
<p>Using the replacement and simplifying results in:
$$f(y \mid \theta, \mu) = \\ \frac{\theta^2 (\mu \theta (\theta+1))^y
(\theta^2 (1+\mu) + \theta (2+\mu) + (\theta+2) (y+1))}{(\theta+1)
(\theta+2)^{y+1} (\theta^2 (1+\mu) + \theta (2+\mu))^{y+2}}$$
And
$$LL=2 \log(\theta) + y (\log(\mu) + \log(\theta) + \log(\theta+1)) +
\log(\theta^2 (1+\mu) + \theta (2+\mu) + (\theta+2) (y+1)) - \log(\theta+1)
- (y+1) \log(\theta+2) - (y+2) \log(\theta^2 (1+\mu) + \theta (2+\mu))$$</p>
<p>The variance function is defined as:
$$\sigma^2=\mu+\left(1-\frac{2}{(\theta+2)^2}\right)\mu^2$$</p>
<p>It should be noted that the p-value for the parameter `ln(theta)` in the
model summary is testing if the parameter `theta` is equal to a value of 1.
This has no practical meaning. The Likelihood-Ratio (LR) test compares the
Poisson-Lindley regression with a Poisson regression with the same
independent variables. Thus, the PR test result indicates the statistical
significance for the improvement in how well the model fits the data over a
Poisson regression. This indicates the statistical significance of the
`theta` parameter.</p>
<p>## Poisson-Lindley-Gamma (PLG) Model
The Poisson-Lindley-Gamma regression is based on a compound Poisson-Lindley-
Gamma distribution. Details of the distribution can be seen at
<code><a href="NegativeBinomialLindley.html">dplindGamma</a></code>.</p>
<p>The mean for the regression model is:
$$\mu=e^{X\beta}$$</p>
<p>The variance function is defined as:
$$\sigma^2=\mu+\left(2\alpha+1-\frac{2(1+\alpha)}
{(\theta+2)^2}\right)\mu^2$$</p>
<p>It should be noted that the p-value for the parameters `ln(theta)` and
`ln(alpha)` in the model summary are testing if the parameter `theta` and
`alpha` are equal to a value of 1.</p>
<p>## Poisson-Lindley-Lognormal (PLL) Model
The Poisson-Lindley-Lognormal regression is based on a compound Poisson-
Lindley-Lognormal distribution. Details of the distribution can be seen at
<code><a href="PoissonLindleyLognormal.html">dplindLnorm</a></code>.</p>
<p>The mean for the regression model is:
$$\mu=e^{X\beta}$$</p>
<p>The variance function is defined as:
$$\sigma^2=\mu+\left(\frac{1-\frac{2}{(\theta+2)^2}}{e^{\frac{\sigma^2}
{2}}}+e^{\sigma^2}-1\right)\mu^2$$</p>
<p>It should be noted that the p-value for the parameters `ln(theta)` and
`ln(sigma)` in the model summary are testing if the parameter `theta` and
`sigma` are equal to a value of 1.</p>
<p>## Poisson-Weibull (PW) Model
The Poisson-Weibull distribution uses the Weibull distribution as a mixing
distribution for a Poisson process. It is useful for modeling overdispersed
count data. The density function (probability mass function) for the
Poisson-Weibull distribution is given by:
$$P(y|\lambda,\alpha,\sigma) = \int_0^\infty \frac{e^{-\lambda x}
\lambda^y x^y }{y!} \left(\frac{\alpha}{\sigma}\right)\left(\frac{x}{\sigma}
\right)^{\alpha-1}e^{-\left(\frac{x}{\sigma}\right)^\alpha} dx$$
where \(f(x| \alpha, \sigma)\) is the PDF of the Weibull distribution and
\(\lambda\) is the mean of the Poisson distribution.</p>
<p>For the Poisson-Weibull Regression model, the expected values is:
$$E[Y]=\lambda\sigma\Gamma\left(1+\frac{1}{\alpha}\right)$$
Where \(\lambda\) is the mean of the Poisson distribution, \(\alpha\) is
the shape parameter, and \(\sigma\) is the scale parameter.</p>
<p>To ensure that the regression model predicts the mean value, the regression
utilizes:
$$\mu=\exp{X\gamma}=\lambda\sigma\Gamma\left(1+\frac{1}{\alpha}\right)$$
Where \(X\) is a matrix of independent variables and \(\gamma\) is a
vector of coefficients.</p>
<p>This leads to:
$$\lambda=\frac{\mu}{\sigma\Gamma\left(1+\frac{1}{\alpha}\right)}$$</p>
<p>The variance for the Poisson-Weibull regression is:
$$V[Y]=\mu+\left(\frac{\Gamma\left(1+\frac{2}{\alpha}\right)}
{\Gamma\left(1+\frac{1}{\alpha}\right)^2}-1\right)\mu^2$$</p>
<p>## Sichel (SI) Model
The compound Probability Mass Function (PMF) for the Sichel distribution uses
the formulation from Zhou et al. (2011) and Rigby et al. (2008):
$$f(y|\mu, \sigma, \gamma)=\frac{\left(\frac{\mu}{c}\right)^y
K_{y+\gamma}(\alpha)}{K_\gamma(1/\sigma)y!(\alpha\sigma)^{y+\gamma}}$$</p>
<p>Where \(\sigma\) and \(\gamma\) are distribution parameters with
\(-\infty &lt; \gamma &lt; \infty\) and \(\sigma&gt;0\),
\(c=\frac{K_{\gamma+1}(1/\sigma)}{K_\gamma(1/\sigma)}\),
\(\alpha^2=\sigma^{-2}+2\mu(c\sigma)^{-1}\),
a mean value of \(\mu\), \(y\) is a non-negative integer, and
\(K_j(x)\) is a modified Bessel function of the third kind with order
\(j\) and argument \(x\).</p>
<p>The variance of the distribution is:
$$\sigma^2=\mu+\left(\frac{2\sigma(\gamma+1)}{c}+\frac{1}{c^2}-1\right)
\mu^2$$</p>
<p>## Generalized Waring (GW) Model
The following are the versions of the PMF, mean, and variance used for the
Generalized Waring model. This is adjusted from the typical formulation by
replacing parameter <code>k</code> with \(\mu\)
$$PMF=\frac{\Gamma(\alpha+y)\Gamma(k+y)\Gamma(\rho+k)\Gamma(\alpha+\rho)}
{y!\Gamma(\alpha)\Gamma(k)\Gamma(\rho)\Gamma(\alpha+k+\rho+y)}$$
$$\mu=e^{X\beta}=\frac{\alpha k}{\rho-1}$$
$$\sigma^2=\frac{\alpha k(\alpha+k+\rho-1)}{(\rho-1)^2(\rho-2)}$$</p>
<p>The distribution parameters are often considered to capture the randomness
(parameter $$\alpha$$), proneness (parameter $$$$k), and liability
(parameter $$\rho$$) of the data.</p>
<p>If we use:
$$\alpha=\frac{\mu k}{\rho-1}$$</p>
<p>The PMF becomes:</p>
<p>$$PMF=\frac{\Gamma\left(\frac{\mu k}{\rho-1}+y\right)\Gamma(k+y)
\Gamma(\rho+k)\Gamma\left(\frac{\mu k}{\rho-1}+\rho\right)}{y!
\Gamma\left(\frac{\mu k}{\rho-1}\right)\Gamma(k)\Gamma(\rho)
\Gamma\left(\frac{\mu k}{\rho-1}+k+\rho+y\right)}$$</p>
<p>This results in a regression model where:
$$\mu=e^{X\beta}$$
$$\sigma^2=\frac{\mu k^2\left(\frac{\mu k}{\rho-1}+k+\rho-1\right)}
{(\rho-1)^3(\rho-2)}=\left(\frac{k^3+\rho k^2- k^2}{(\rho-1)^3(\rho-2)}
\right)\mu+\left(\frac{k^3}{(\rho-1)^4(\rho-2)}\right)\mu^2$$</p>
<p>Note that when $$p=1$$ or $$p=2$$, the distribution is undefined.</p>
<p>## Conway-Maxwell-Poisson (COM) Model
The following is the the PMF for the COM model.
$$f(x|\lambda, \nu)=\frac{\lambda^x}{(x!)^\nu Z(\lambda,\nu)}$$</p>
<p>Where \(\lambda\) and \(\nu\) are distribution parameters with
\(\lambda&gt;0\) and \(\nu&gt;0\), and \(Z(\lambda,\nu)\) is the normalizing
constant.</p>
<p>The normalizing constant is given by:
$$Z(\lambda,\nu)=\sum_{n=0}^{\infty}\frac{\lambda^n}{(n!)^\nu}$$</p>
<p>The mean and variance are:
$$\mu=e^{X\beta}=\lambda \frac{\delta}{\delta \lambda} \log(Z(\lambda,
\nu))$$
$$\sigma^2=\lambda \frac{\delta}{\delta \lambda} \mu$$</p>
<p>Note that the COM distribution parameter \(\lambda\) is solved for using
\(\mu\) and \(\nu\), so the regression model provides direct predictions
for the mean.</p>
<p>## Underreporting
Models for underreporting combine a binary probability model (logit or
probit) with a count model. This is accomplished using a model for the
probability of crashes being reported multiplied by the estimated mean for
the count model, based on the observed data. This is discussed in Wood et.
al. (2016), Pararai et. al., (2006), and Pararai et. al., (2010). The
underreporting model is based on:
$$\mu_{true}=\mu_{observed}\cdot P(\text{event is reported})$$</p>
<p>This allows the inference of both the true event count and the probability of
the event being reported as a function of independent variables.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Greene, W. (2008). Functional forms for the negative binomial model for count
data. Economics Letters, 99(3), 585-590.</p>
<p>Pararai, M., Famoye, F., &amp; Lee, C. (2006). Generalized Poisson regression
model for underreported counts. Advances and applications in Statistics,
6(3), 305-322.</p>
<p>Pararai, M., Famoye, F., &amp; Lee, C. (2010). Generalized Poisson-Poisson
mixture model for misreported counts with an application to smoking data.
Journal of Data Science, 8(4), 607-617.</p>
<p>Rigby, R. A., Stasinopoulos, D. M., &amp; Akantziliotou, C. (2008). A framework
for modelling overdispersed count data, including the Poisson-shifted
generalized inverse Gaussian distribution. Computational Statistics &amp; Data
Analysis, 53(2), 381-393.</p>
<p>Wood, J.S., Eric T. Donnell, &amp; Christopher J. Fariss. "A method to account
for and estimate underreporting in crash frequency research." Accident
Analysis &amp; Prevention 95 (2016): 57-66.</p>
<p>Zou, Y., Lord, D., &amp; Zhang, Y. (2012). Analyzing highly dispersed crash data
using the Sichel generalized additive models for location, scale and shape.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load the Washington data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"washington_roads"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">washington_roads</span><span class="op">$</span><span class="va">AADT10kplus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">washington_roads</span><span class="op">$</span><span class="va">AADT</span> <span class="op">&gt;</span> <span class="fl">10000</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Estimate an NB2 model with a dispersion parameter as a function of the </span></span></span>
<span class="r-in"><span><span class="co"># variable `speed50` (i.e., generalized NB2), verbose output, and use the </span></span></span>
<span class="r-in"><span><span class="co"># BFGS optimization method</span></span></span>
<span class="r-in"><span><span class="va">nb2</span> <span class="op">&lt;-</span> <span class="fu">countreg</span><span class="op">(</span><span class="va">Total_crashes</span> <span class="op">~</span> <span class="va">lnaadt</span> <span class="op">+</span> <span class="va">lnlength</span> <span class="op">+</span> <span class="va">speed50</span> <span class="op">+</span> <span class="va">AADT10kplus</span>,</span></span>
<span class="r-in"><span>               data <span class="op">=</span> <span class="va">washington_roads</span>, family <span class="op">=</span> <span class="st">"NB2"</span>,</span></span>
<span class="r-in"><span>               dis_param_formula_1 <span class="op">=</span> <span class="op">~</span> <span class="va">speed50</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>               method<span class="op">=</span><span class="st">'BFGS'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1087.972055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   2 value 1086.761180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   3 value 1082.460820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   4 value 1081.386386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   5 value 1080.983879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   6 value 1079.708978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   7 value 1070.603400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   8 value 1068.239212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter   9 value 1065.881518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1065.612937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  11 value 1065.068995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  12 value 1064.893660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  13 value 1064.876776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  14 value 1064.876161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  15 value 1064.876105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  15 value 1064.876105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  15 value 1064.876105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 1064.876105 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nb2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Total_crashes ~ lnaadt + lnlength + speed50 + AADT10kplus </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method:  countreg </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations:  44 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence:  successful convergence  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood:  -1064.876 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Using bootstrapped standard errors)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parameter           coeff `Std. Err.` `t-stat` `p-value` `lower CI` `upper CI`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)        -<span style="color: #BB0000;">7.40</span>        0.043  -<span style="color: #BB0000;">172.</span>       0         -<span style="color: #BB0000;">7.49</span>      -<span style="color: #BB0000;">7.32</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> lnaadt              0.912       0.005   182.       0          0.902      0.921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> lnlength            0.843       0.037    22.9      0          0.771      0.915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> speed50            -<span style="color: #BB0000;">0.47</span>        0.102    -<span style="color: #BB0000;">4.61</span>     0         -<span style="color: #BB0000;">0.67</span>      -<span style="color: #BB0000;">0.27</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> AADT10kplus         0.77        0.09      8.59     0          0.594      0.945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ln(alpha):(Interc… -<span style="color: #BB0000;">1.62</span>        0.288    -<span style="color: #BB0000;">5.62</span>     0         -<span style="color: #BB0000;">2.18</span>      -<span style="color: #BB0000;">1.06</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> ln(alpha):speed50   1.31        0.458     2.85     0.004      0.409      2.20 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate a Poisson-Lognormal model (a low number of draws is used to speed </span></span></span>
<span class="r-in"><span><span class="co"># up the estimation for examples - not recommended in practice)</span></span></span>
<span class="r-in"><span><span class="va">pln</span> <span class="op">&lt;-</span> <span class="fu">countreg</span><span class="op">(</span><span class="va">Total_crashes</span> <span class="op">~</span> <span class="va">lnaadt</span> <span class="op">+</span> <span class="va">lnlength</span> <span class="op">+</span> <span class="va">speed50</span> <span class="op">+</span> <span class="va">AADT10kplus</span>,</span></span>
<span class="r-in"><span>              data <span class="op">=</span> <span class="va">washington_roads</span>, family <span class="op">=</span> <span class="st">"PLN"</span>, ndraws<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pln</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Total_crashes ~ lnaadt + lnlength + speed50 + AADT10kplus </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method:  countreg </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations:  485 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence:  successful convergence  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood:  -1075.729 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Using bootstrapped standard errors)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parameter    coeff `Std. Err.` `t-stat` `p-value` `lower CI` `upper CI`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept) -<span style="color: #BB0000;">7.78</span>        0.038  -<span style="color: #BB0000;">205.</span>       0         -<span style="color: #BB0000;">7.85</span>      -<span style="color: #BB0000;">7.70</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> lnaadt       0.907       0.004   209.       0          0.898      0.915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> lnlength     0.827       0.033    24.9      0          0.762      0.892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> speed50     -<span style="color: #BB0000;">0.434</span>       0.086    -<span style="color: #BB0000;">5.08</span>     0         -<span style="color: #BB0000;">0.602</span>     -<span style="color: #BB0000;">0.267</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> AADT10kplus  0.774       0.071    10.9      0          0.635      0.913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ln(sigma)    0.117       0.096     1.22     0.222     -<span style="color: #BB0000;">0.071</span>      0.304</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate an Poisson-Lognormal with underreporting (probit)</span></span></span>
<span class="r-in"><span><span class="va">plogn_underreport</span> <span class="op">&lt;-</span> <span class="fu">countreg</span><span class="op">(</span><span class="va">Total_crashes</span> <span class="op">~</span> <span class="va">lnaadt</span> <span class="op">+</span> <span class="va">lnlength</span> <span class="op">+</span> <span class="va">speed50</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>               <span class="va">AADT10kplus</span>,</span></span>
<span class="r-in"><span>              data <span class="op">=</span> <span class="va">washington_roads</span>, family <span class="op">=</span> <span class="st">"NB2"</span>,</span></span>
<span class="r-in"><span>              underreport_formula <span class="op">=</span> <span class="op">~</span> <span class="va">speed50</span> <span class="op">+</span> <span class="va">AADT10kplus</span>, </span></span>
<span class="r-in"><span>              underreport_family <span class="op">=</span> <span class="st">"probit"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">plogn_underreport</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Total_crashes ~ lnaadt + lnlength + speed50 + AADT10kplus </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method:  countreg </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations:  494 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence:  successful convergence  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood:  -1065.087 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Using bootstrapped standard errors)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 9 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parameter           coeff `Std. Err.` `t-stat` `p-value` `lower CI` `upper CI`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)        -<span style="color: #BB0000;">6.69</span>        0.043  -<span style="color: #BB0000;">157.</span>       0         -<span style="color: #BB0000;">6.78</span>      -<span style="color: #BB0000;">6.61</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> lnaadt              0.901       0.005   182.       0          0.892      0.911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> lnlength            0.832       0.037    22.6      0          0.76       0.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> speed50            -<span style="color: #BB0000;">0.924</span>       0.093    -<span style="color: #BB0000;">9.92</span>     0         -<span style="color: #BB0000;">1.11</span>      -<span style="color: #BB0000;">0.741</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> AADT10kplus         2.22        0.09     24.7      0          2.04       2.40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ln(alpha)          -<span style="color: #BB0000;">1.50</span>        0.34     -<span style="color: #BB0000;">4.42</span>     0         -<span style="color: #BB0000;">2.17</span>      -<span style="color: #BB0000;">0.838</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> Underreporting:(I… -<span style="color: #BB0000;">0.085</span>       0.044    -<span style="color: #BB0000;">1.93</span>     0.054     -<span style="color: #BB0000;">0.172</span>      0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> Underreporting:sp… -<span style="color: #BB0000;">0.774</span>       0.21     -<span style="color: #BB0000;">3.69</span>     0         -<span style="color: #BB0000;">1.18</span>      -<span style="color: #BB0000;">0.362</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">9</span> Underreporting:AA…  1.25        0.056    22.4      0          1.14       1.35 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate a Conway-Maxwell-Poisson model</span></span></span>
<span class="r-in"><span><span class="va">com_model</span> <span class="op">&lt;-</span> <span class="fu">countreg</span><span class="op">(</span><span class="va">Total_crashes</span> <span class="op">~</span> <span class="va">lnaadt</span> <span class="op">+</span> <span class="va">lnlength</span> <span class="op">+</span> <span class="va">speed50</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>                      <span class="va">AADT10kplus</span>,</span></span>
<span class="r-in"><span>                      data <span class="op">=</span> <span class="va">washington_roads</span>, family <span class="op">=</span> <span class="st">"COM"</span>, method<span class="op">=</span><span class="st">"BHHH"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">com_model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Total_crashes ~ lnaadt + lnlength + speed50 + AADT10kplus </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method:  countreg </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations:  6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence:  successive function values within tolerance limit (tol) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood:  -1066.063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Using bootstrapped standard errors)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parameter    coeff `Std. Err.` `t-stat` `p-value` `lower CI` `upper CI`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept) -<span style="color: #BB0000;">7.42</span>        0.043  -<span style="color: #BB0000;">174.</span>           0     -<span style="color: #BB0000;">7.50</span>      -<span style="color: #BB0000;">7.34</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> lnaadt       0.912       0.005   185.           0      0.903      0.922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> lnlength     0.84        0.036    23.2          0      0.769      0.911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> speed50     -<span style="color: #BB0000;">0.445</span>       0.088    -<span style="color: #BB0000;">5.05</span>         0     -<span style="color: #BB0000;">0.618</span>     -<span style="color: #BB0000;">0.272</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> AADT10kplus  0.788       0.085     9.25         0      0.621      0.955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ln(nu)      -<span style="color: #BB0000;">0.62</span>        0.171    -<span style="color: #BB0000;">3.63</span>         0     -<span style="color: #BB0000;">0.955</span>     -<span style="color: #BB0000;">0.285</span></span>
<span class="r-in"><span><span class="co">## }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonathan Wood.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

